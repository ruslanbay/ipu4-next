From 77c1be3270a215992e31ca32f0b7061e6de38b58 Mon Sep 17 00:00:00 2001
From: ruslanbay <67730802+ruslanbay@users.noreply.github.com>
Date: Wed, 3 Dec 2025 15:17:38 +0100
Subject: [PATCH 09/21] fix: Use strscpy() instead of the deprecated strlcpy()

---
 drivers/media/pci/intel/ipu-isys-video.c |  6 +++---
 drivers/media/pci/intel/ipu-isys.c       |  4 ++--
 drivers/media/pci/intel/ipu-psys.c       |  2 +-
 drivers/media/platform/intel/ipu4-acpi.c | 12 ++++++------
 4 files changed, 12 insertions(+), 12 deletions(-)

diff --git a/drivers/media/pci/intel/ipu-isys-video.c b/drivers/media/pci/intel/ipu-isys-video.c
index 0928ba92a246..22256f61920d 100644
--- a/drivers/media/pci/intel/ipu-isys-video.c
+++ b/drivers/media/pci/intel/ipu-isys-video.c
@@ -332,8 +332,8 @@ int ipu_isys_vidioc_querycap(struct file *file, void *fh,
 {
 	struct ipu_isys_video *av = video_drvdata(file);
 
-	strlcpy(cap->driver, IPU_ISYS_NAME, sizeof(cap->driver));
-	strlcpy(cap->card, av->isys->media_dev.model, sizeof(cap->card));
+	strscpy(cap->driver, IPU_ISYS_NAME, sizeof(cap->driver));
+	strscpy(cap->card, av->isys->media_dev.model, sizeof(cap->card));
 	snprintf(cap->bus_info, sizeof(cap->bus_info), "PCI:%s",
 		 av->isys->media_dev.bus_info);
 
@@ -611,7 +611,7 @@ static int vidioc_enum_input(struct file *file, void *fh,
 {
 	if (input->index > 0)
 		return -EINVAL;
-	strlcpy(input->name, "camera", sizeof(input->name));
+	strscpy(input->name, "camera", sizeof(input->name));
 	input->type = V4L2_INPUT_TYPE_CAMERA;
 
 	return 0;
diff --git a/drivers/media/pci/intel/ipu-isys.c b/drivers/media/pci/intel/ipu-isys.c
index 95344bb1ac87..a60935610fa6 100644
--- a/drivers/media/pci/intel/ipu-isys.c
+++ b/drivers/media/pci/intel/ipu-isys.c
@@ -400,11 +400,11 @@ static int isys_register_devices(struct ipu_isys *isys)
 
 	isys->media_dev.dev = &isys->adev->dev;
 	isys->media_dev.ops = &isys_mdev_ops;
-	strlcpy(isys->media_dev.model,
+	strscpy(isys->media_dev.model,
 		IPU_MEDIA_DEV_MODEL_NAME, sizeof(isys->media_dev.model));
 	snprintf(isys->media_dev.bus_info, sizeof(isys->media_dev.bus_info),
 		 "pci:%s", dev_name(isys->adev->dev.parent->parent));
-	strlcpy(isys->v4l2_dev.name, isys->media_dev.model,
+	strscpy(isys->v4l2_dev.name, isys->media_dev.model,
 		sizeof(isys->v4l2_dev.name));
 
 	media_device_init(&isys->media_dev);
diff --git a/drivers/media/pci/intel/ipu-psys.c b/drivers/media/pci/intel/ipu-psys.c
index b1498f64f319..b0e19cb40d1d 100644
--- a/drivers/media/pci/intel/ipu-psys.c
+++ b/drivers/media/pci/intel/ipu-psys.c
@@ -1402,7 +1402,7 @@ static int ipu_psys_probe(struct ipu_bus_device *adev)
 	}
 
 	/* Add the hw stepping information to caps */
-	strlcpy(caps.dev_model, IPU_MEDIA_DEV_MODEL_NAME,
+	strscpy(caps.dev_model, IPU_MEDIA_DEV_MODEL_NAME,
 		sizeof(caps.dev_model));
 
 	pm_runtime_allow(&adev->dev);
diff --git a/drivers/media/platform/intel/ipu4-acpi.c b/drivers/media/platform/intel/ipu4-acpi.c
index bf9bdcb80265..44209f81203b 100644
--- a/drivers/media/platform/intel/ipu4-acpi.c
+++ b/drivers/media/platform/intel/ipu4-acpi.c
@@ -144,7 +144,7 @@ static int add_new_i2c(unsigned short addr, unsigned short  bus,
 	newdev->info.addr = addr;
 	newdev->bus = bus;
 	newdev->info.platform_data = pdata;
-	strlcpy(newdev->info.type, name, sizeof(newdev->info.type));
+	strscpy(newdev->info.type, name, sizeof(newdev->info.type));
 
 	list_add(&newdev->list, &new_devs);
 	return 0;
@@ -167,7 +167,7 @@ static int get_string_dsdt_data(struct device *dev, const u8 *dsdt,
 	if ((obj->type != ACPI_TYPE_STRING) || !obj->string.pointer)
 		goto exit;
 
-	strlcpy(out, obj->string.pointer,
+	strscpy(out, obj->string.pointer,
 		min((unsigned int)(obj->string.length + 1), size));
 	dev_info(dev, "DSDT string id: %s\n", out);
 
@@ -272,7 +272,7 @@ static void *get_dsdt_vcm(struct device *dev, char *vcm, char *second)
 				       vcm, VCM_BUFFER_SIZE);
 	if (ret < 0) {
 		dev_err(dev, "get vcm failed - using override: %s\n", second);
-		strlcpy(vcm, second, VCM_BUFFER_SIZE);
+		strscpy(vcm, second, VCM_BUFFER_SIZE);
 	}
 	dev_dbg(dev, "vcm: %s\n", vcm);
 
@@ -285,7 +285,7 @@ static void *get_dsdt_vcm(struct device *dev, char *vcm, char *second)
 		if (lc_pdata)
 			lc_pdata->sensor_device = dev;
 		pdata = lc_pdata;
-		strlcpy(vcm, LC898122_NAME, VCM_BUFFER_SIZE);
+		strscpy(vcm, LC898122_NAME, VCM_BUFFER_SIZE);
 	} else if (!strcasecmp(vcm, DW9714_NAME)) {
 		struct dw9714_platform_data *dw_pdata;
 
@@ -300,7 +300,7 @@ static void *get_dsdt_vcm(struct device *dev, char *vcm, char *second)
 				dw_pdata->gpio_xsd = -ENODEV;
 		}
 		pdata = dw_pdata;
-		strlcpy(vcm, DW9714_NAME, VCM_BUFFER_SIZE);
+		strscpy(vcm, DW9714_NAME, VCM_BUFFER_SIZE);
 	}
 	return pdata;
 }
@@ -908,7 +908,7 @@ static int ipu_acpi_pdata(struct i2c_client *client,
 	if (!camdata)
 		return -ENOMEM;
 
-	strlcpy(client->name, supported_devices[index].real_driver,
+	strscpy(client->name, supported_devices[index].real_driver,
 		sizeof(client->name));
 
 	regulators = supported_devices[index].regulators;
-- 
2.43.0

